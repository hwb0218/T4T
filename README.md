# ğŸ“Œ Thanks for traveling
__`ì—¬í–‰íŒ¨í‚¤ì§€ ì‡¼í•‘ëª°`__
> Demolink
> [Thanks for traveling](http://t4t-node.herokuapp.com/)
        
</br>

## 1. ì œì‘ ê¸°ê°„
- 2021ë…„ 3ì›” ~ 2021ë…„ 5ì›”
- ê°œì¸ í”„ë¡œì íŠ¸

</br>

## 2. ì‚¬ìš© ê¸°ìˆ 
#### `Front-end`
- React / Hooks
- Redux
- Styled-components
- Javascript ES6+
- Third-party-library (axios, react-hook-form ë“±)
#### `Back-end`
- Node.js
- Express
- MongoDB
- Mongoose
- Heroku
- Third-party-library (jwt, bcrypt ë“±)

</br>

## 3. ERD ì„¤ê³„
![t4t_erd](https://user-images.githubusercontent.com/52212226/120163016-fbe2d680-c233-11eb-93ce-543d9a336687.PNG)

</br>

## 4. ì£¼ìš” ê¸°ëŠ¥
ìºëŸ¬ì…€ ìŠ¬ë¼ì´ë”, í˜ì´ì§€ë„¤ì´ì…˜, ê²€ìƒ‰ê¸°ëŠ¥, ë°˜ì‘í˜• ì›¹ ë””ìì¸ì„ í•˜ì˜€ìœ¼ë©°       
ì˜µì…˜ì— ë”°ë¥¸ ìƒí’ˆì¶œë ¥, ìƒí’ˆ ì¥ë°”êµ¬ë‹ˆì— ë‹´ê¸°, ì£¼ë¬¸ ë° êµ¬ë§¤í™•ì •, í‰ì  ë° ë¦¬ë·°ì‘ì„±, Q&A, ìƒí’ˆ ì—…ë¡œë“œì…ë‹ˆë‹¤.

<details>
<summary><b>ì£¼ìš” ê¸°ëŠ¥ ì˜ìƒ í¼ì¹˜ê¸°</b></summary>
<div markdown="1">

### 4.1 ì˜µì…˜ ë° ê²€ìƒ‰ì— ë”°ë¥¸ ìƒí’ˆ ì¶œë ¥ 
![](https://user-images.githubusercontent.com/52212226/120294979-aecd3600-c301-11eb-9b25-28f1588298da.gif)
### 4.2 ì¥ë°”êµ¬ë‹ˆ ë‹´ê¸°
![](https://user-images.githubusercontent.com/52212226/120295838-81cd5300-c302-11eb-9473-238813dedef4.gif)
### 4.3 ì£¼ë¬¸ ë° êµ¬ë§¤ í™•ì •
![](https://user-images.githubusercontent.com/52212226/120296117-c3f69480-c302-11eb-8905-e83ae5f0d210.gif)
### 4.4 í‰ì  ë° ë¦¬ë·° ì‘ì„±
![](https://user-images.githubusercontent.com/52212226/120296479-2059b400-c303-11eb-8177-62d841152240.gif)
### 4.5 Q&A 
![](https://user-images.githubusercontent.com/52212226/120297973-9874a980-c304-11eb-9470-49d5a7d2cbdd.gif)
### 4.6 ìƒí’ˆ ì—…ë¡œë“œ
![](https://user-images.githubusercontent.com/52212226/120298619-3799a100-c305-11eb-8a41-2ee2579ac327.gif)

</div>
</details>

</br>

## 5. íŠ¸ëŸ¬ë¸” ìŠˆíŒ…
### 5.1 ìƒˆë¡œê³ ì¹¨ ì‹œ ë¦¬ë•ìŠ¤ storeì˜ state ì´ˆê¸°í™”
- historyPage, CartPage ì»´í¬ë„ŒíŠ¸ì—ì„œ useEffect hooksë¥¼ ì‚¬ìš©í•´ ì»´í¬ë„ŒíŠ¸ê°€ ë Œë”ë§ ë  ë•Œ ë¹„ë™ê¸° ì²˜ë¦¬ë¥¼ í•˜ê³  ìˆìŠµë‹ˆë‹¤. 

- ì´ ë•Œ, post ìš”ì²­ ë°ì´í„°ë¡œ ë¦¬ë•ìŠ¤ storeì˜ user stateë¥¼ ì´ìš©í•´ ì´ìš©ìì˜ ì£¼ë¬¸ì •ë³´ì™€, ì¥ë°”êµ¬ë‹ˆ ìƒí’ˆì„ ê°€ì ¸ì˜¤ê³  ìˆê³               
  ì„±ê³µì ìœ¼ë¡œ ë¹„ë™ê¸° ì²˜ë¦¬ê°€ ë˜ê³ ìˆìŠµë‹ˆë‹¤.
  
- í•˜ì§€ë§Œ í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨ì„ í•  ê²½ìš° ë¦¬ë•ìŠ¤ storeì˜ stateê°€ ì´ˆê¸°í™” ë˜ì–´ë²„ë¦¬ê¸° ë•Œë¬¸ì—,                  
  user stateë¥¼ ì´ìš©í•œ DB ë°ì´í„°ë¥¼ ê°€ì ¸ ì˜¬ ìˆ˜ ì—†ì—ˆìŠµë‹ˆë‹¤.

- ë•Œë¬¸ì— redux state ì´ˆê¸°í™”ì— ëŒ€í•´ êµ¬ê¸€ë§ í•˜ì˜€ìœ¼ë©°, í•´ê²°ë°©ë²•ìœ¼ë¡œ __redux-persist__ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í–ˆìŠµë‹ˆë‹¤.

- redux-persistë¥¼ ì‚¬ìš©í•˜ì—¬ redux stateë¥¼ ì›¹ ìŠ¤í† ë¦¬ì§€ì— ì €ì¥í•˜ê³ , ìƒˆë¡œê³ ì¹¨ ì‹œì—ë„ ì €ì¥ê³µê°„ì— ìˆëŠ” ë°ì´í„°ë¥¼ reduxì— ë¶ˆëŸ¬ì™€             
  stateë¥¼ ì •ìƒì ìœ¼ë¡œ ìœ ì§€í•˜ê²Œ ëìŠµë‹ˆë‹¤.
  
### 5.2 MongoDB ë°°ì—´ í•„ë“œ ë‚´ë¦¼ì°¨ìˆœ ì •ë ¬
- ìƒí’ˆ ì£¼ë¬¸ í˜ì´ì§€ë¥¼ ë³´ë©´ ì¼ë°˜ì ìœ¼ë¡œ ê°€ì¥ ìµœê·¼ì˜ ì£¼ë¬¸ì´ ë¦¬ìŠ¤íŠ¸ ë§¨ ìœ„ì— ì˜¬ë¼ì™€ ìˆìŠµë‹ˆë‹¤.

- MongoDBì—ì„œ select í•œ ë°ì´í„°ë¥¼ ì˜¤ë¦„ì°¨ìˆœì´ë‚˜ ë‚´ë¦¼ì°¨ìˆœìœ¼ë¡œ ì •ë ¬ í•  ê²½ìš° sort() ë©”ì†Œë“œë¥¼ ì‚¬ìš©í•˜ë©´ ë˜ê¸° ë•Œë¬¸ì—                 
  ë°°ì—´ í•„ë“œì—ë„ ë˜‘ê°™ì´ ì ìš©í•˜ë©´ ë  ê²ƒì´ë¼ ìƒê°í–ˆìŠµë‹ˆë‹¤.

- í•˜ì§€ë§Œ sort()ëŠ” documentë¥¼ ì •ë ¬í•˜ëŠ” ë©”ì†Œë“œì´ê¸° ë•Œë¬¸ì— ë°°ì—´ íƒ€ì… í•„ë“œì—ì„œì˜ ì‚¬ìš©ì´ ë¶ˆê°€ëŠ¥ í–ˆìŠµë‹ˆë‹¤. 
   
- ë‹¤ë¥¸ í•´ê²°ë°©ë²•ì„ ì°¾ê¸°ìœ„í•´ êµ¬ê¸€ë§ì„ í•˜ì˜€ê³ , aggregate() ë©”ì†Œë“œë¥¼ í†µí•´ ë°°ì—´ í•„ë“œë¥¼ ê°€ê³µí•  ìˆ˜ ìˆë‹¤ëŠ” ê²ƒì„ ì•Œì•„ëƒˆìŠµë‹ˆë‹¤.
  
  <details>
  <summary><b>í•´ê²°í•œ ì½”ë“œ</b></summary>
  <div markdown="1">

  ~~~javascript
  const history = await Payment.aggregate([
  {
    $match: { user: ObjectId(userId) },
  }
  { $unwind: "$products" },
  { $sort: { "products.createdAt": -1 } },
  {
    $lookup: {
      from: "products",
      localField: "products.productDetail",
      foreignField: "_id",
      as: "products.productDetail",
    },
  },
  { $unwind: "$products.productDetail" },
  {
    $group: {
      products: { $push: "$products" },
      _id: "$_id",
      user: { $first: "$user" },
      createdMonth: { $first: "$createdMonth" },
    },
  },
  ]).sort({ createdMonth: -1 });
  ~~~

  </div>
  </details>

- $sortë¥¼ ì‚¬ìš©í•˜ì—¬ ë‚´ë¦¼ì°¨ìˆœ ì •ë ¬, aggregate() ë©”ì†Œë“œë¥¼ ì‚¬ìš©í•˜ë©´ Mongooseì˜ populate() ë©”ì†Œë“œë¡œ                 
  products ì»¬ë ‰ì…˜ documentë¥¼ ì°¸ì¡°í•  ìˆ˜ ì—†ì–´ $lookupì„ ì‚¬ìš©í•´ payments ì»¬ë ‰ì…˜ í•„ë“œì— products ì»¬ë ‰ì…˜ í•„ë“œë¥¼ ì¡°ì¸,                  
  $groupìœ¼ë¡œ íŠ¹ì • í•„ë“œ ê·¸ë£¹í•‘ì„ ìˆ˜í–‰í–ˆìŠµë‹ˆë‹¤.
  
  <details>
  <summary><b>aggregate ê²°ê³¼</b></summary>      
  <div markdown="1">
  
  ![aggregate](https://user-images.githubusercontent.com/52212226/120635348-56379d80-c4a7-11eb-9598-639bd0c7f88d.PNG)        
  
  </div>
  </details>        
          
</br>

## 6. ëŠë‚€ì 
ì•ˆì˜¬ê²ƒë§Œ ê°™ì•˜ë˜ í”„ë¡œì íŠ¸ë¥¼ ì„±ê³µì ìœ¼ë¡œ ëë§ˆì³¤ìŠµë‹ˆë‹¤.                    
ì‚¬ìš©í•´ë³¸ì  ì—†ì—ˆë˜ ë¦¬ì•¡íŠ¸ë¥¼ ì‚¬ìš©í•˜ë ¤ê³  í•˜ë‹ˆ ë‚¯ì„¤ê³  ì‚¬ìš©ë²•ê³¼ ë™ì‘ì›ë¦¬ë¥¼ ì´í•´í•˜ëŠ”ë° ì• ë¥¼ ë¨¹ê¸°ë„ í–ˆìŠµë‹ˆë‹¤.               
í•˜ì§€ë§Œ ìë°”ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì²˜ìŒ ë°°ì› ì„ ë•Œ ì²˜ëŸ¼     
